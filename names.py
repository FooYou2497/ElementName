elements_name = {1: 'H', 2: 'He', 3: 'Li', 4: 'Be', 5: 'B', 6: 'C', 7: 'N', 8: 'O', 9: 'F', 10: 'Ne', 11: 'Na', 12: 'Mg', 13: 'Al', 14: 'Si', 15: 'P', 16: 'S', 17: 'Cl', 18: 'Ar', 19: 'K', 20: 'Ca', 21: 'Sc', 22: 'Ti', 23: 'V', 24: 'Cr', 25: 'Mn', 26: 'Fe', 27: 'Co', 28: 'Ni', 29: 'Cu', 30: 'Zn', 31: 'Ga', 32: 'Ge', 33: 'As', 34: 'Se', 35: 'Br', 36: 'Kr', 37: 'Rb', 38: 'Sr', 39: 'Y', 40: 'Zr', 41: 'Nb', 42: 'Mo', 43: 'Tc', 44: 'Ru', 45: 'Rh', 46: 'Pd', 47: 'Ag', 48: 'Cd', 49: 'In', 50: 'Sn', 51: 'Sb', 52: 'Te', 53: 'I', 54: 'Xe', 55: 'Cs', 56: 'Ba', 57: 'La', 58: 'Ce', 59: 'Pr', 60: 'Nd', 61: 'Pm', 62: 'Sm', 63: 'Eu', 64: 'Gd', 65: 'Tb', 66: 'Dy', 67: 'Ho', 68: 'Er', 69: 'Tm', 70: 'Yb', 71: 'Lu', 72: 'Hf', 73: 'Ta', 74: 'W', 75: 'Re', 76: 'Os', 77: 'Ir', 78: 'Pt', 79: 'Au', 80: 'Hg', 81: 'Tl', 82: 'Pb', 83: 'Bi', 84: 'Po', 85: 'At', 86: 'Rn', 87: 'Fr', 88: 'Ra', 89: 'Ac', 90: 'Th', 91: 'Pa', 92: 'U', 93: 'Np', 94: 'Pu', 95: 'Am', 96: 'Cm', 97: 'Bk', 98: 'Cf', 99: 'Es', 100: 'Fm', 101: 'Md', 102: 'No', 103: 'Lr', 104: 'Rf', 105: 'Db', 106: 'Sg', 107: 'Bh', 108: 'Hs', 109: 'Mt', 110: 'Ds', 111: 'Rg', 112: 'Cn', 113: 'Nh', 114: 'Fl', 115: 'Mc', 116: 'Lv', 117: 'Ts', 118: 'Og'}
elements_latin_name = {1: 'Hydrogenium', 2: 'Helium', 3: 'Lithium', 4: 'Beryllium', 5: 'Boron', 6: 'Carboneum', 7: 'Nitrogenium', 8: 'Oxygenium', 9: 'Fluorum', 10: 'Neon', 11: 'Natrium', 12: 'Magnesium', 13: 'Aluminium', 14: 'Silicium', 15: 'Phosphorus', 16: 'Sulfur', 17: 'Chlorinum', 18: 'Argon', 19: 'Kalium', 20: 'Calcium', 21: 'Scandium', 22: 'Titanium', 23: 'Vanadium', 24: 'Chromium', 25: 'Manganum', 26: 'Ferrum', 27: 'Cobaltum', 28: 'Nickel', 29: 'Cuprum', 30: 'Zincum', 31: 'Gallium', 32: 'Germanium', 33: 'Arsenicum', 34: 'Selenium', 35: 'Bromum', 36: 'Krypton', 37: 'Rubidium', 38: 'Strontium', 39: 'Yttrium', 40: 'Zirconium', 41: 'Niobium', 42: 'Molybdaenum', 43: 'Technetium', 44: 'Ruthenium', 45: 'Rhodium', 46: 'Palladium', 47: 'Argentum', 48: 'Cadmium', 49: 'Indium', 50: 'Stannum', 51: 'Antimonium', 52: 'Tellurium', 53: 'Iodium', 54: 'Xenon', 55: 'Cesium', 56: 'Barium', 57: 'Lanthanum', 58: 'Cerium', 59: 'Praseodymium', 60: 'Neodymium', 61: 'Promethium', 62: 'Samarium', 63: 'Europium', 64: 'Gadolinium', 65: 'Terbium', 66: 'Dysprosium', 67: 'Holmium', 68: 'Erbium', 69: 'Thulium', 70: 'Ytterbium', 71: 'Lutetium', 72: 'Hafnium', 73: 'Tantalum', 74: 'Wolframium', 75: 'Rhenium', 76: 'Osmium', 77: 'Iridium', 78: 'Platinum', 79: 'Aurum', 80: 'Hydrargyrum', 81: 'Thallium', 82: 'Plumbum', 83: 'Bismuthum', 84: 'Polonium', 85: 'Astatinum', 86: 'Radon', 87: 'Francium', 88: 'Radium', 89: 'Actinium', 90: 'Thorium', 91: 'Protactinium', 92: 'Uranium', 93: 'Neptunium', 94: 'Plutonium', 95: 'Americium', 96: 'Curium', 97: 'Berkelium', 98: 'Californium', 99: 'Einsteinium', 100: 'Fermium', 101: 'Mendelevium', 102: 'Nobelium', 103: 'Lawrencium', 104: 'Rutherfordium', 105: 'Dubnium', 106: 'Seaborgium', 107: 'Bohrium', 108: 'Hassium', 109: 'Meitnerium', 110: 'Darmstadtium', 111: 'Roentgenium', 112: 'Copernicium', 113: 'Nihonium', 114: 'Flerovium', 115: 'Moscovium', 116: 'Livermorium', 117: 'Tennessine', 118: 'Oganesson'}
elements_IUPAC_name = {1: 'U', 2: 'B', 3: 'T', 4: 'Q', 5: 'P', 6: 'H', 7: 'S', 8: 'O', 9: 'E', 10: 'Un', 11: 'Uu', 12: 'Ub', 13: 'Ut', 14: 'Uq', 15: 'Up', 16: 'Uh', 17: 'Us', 18: 'Uo', 19: 'Ue', 20: 'Bn', 21: 'Bu', 22: 'Bb', 23: 'Bt', 24: 'Bq', 25: 'Bp', 26: 'Bh', 27: 'Bs', 28: 'Bo', 29: 'Be', 30: 'Tn', 31: 'Tu', 32: 'Tb', 33: 'Tt', 34: 'Tq', 35: 'Tp', 36: 'Th', 37: 'Ts', 38: 'To', 39: 'Te', 40: 'Qn', 41: 'Qu', 42: 'Qb', 43: 'Qt', 44: 'Qq', 45: 'Qp', 46: 'Qh', 47: 'Qs', 48: 'Qo', 49: 'Qe', 50: 'Pn', 51: 'Pu', 52: 'Pb', 53: 'Pt', 54: 'Pq', 55: 'Pp', 56: 'Ph', 57: 'Ps', 58: 'Po', 59: 'Pe', 60: 'Hn', 61: 'Hu', 62: 'Hb', 63: 'Ht', 64: 'Hq', 65: 'Hp', 66: 'Hh', 67: 'Hs', 68: 'Ho', 69: 'He', 70: 'Sn', 71: 'Su', 72: 'Sb', 73: 'St', 74: 'Sq', 75: 'Sp', 76: 'Sh', 77: 'Ss', 78: 'So', 79: 'Se', 80: 'On', 81: 'Ou', 82: 'Ob', 83: 'Ot', 84: 'Oq', 85: 'Op', 86: 'Oh', 87: 'Os', 88: 'Oo', 89: 'Oe', 90: 'En', 91: 'Eu', 92: 'Eb', 93: 'Et', 94: 'Eq', 95: 'Ep', 96: 'Eh', 97: 'Es', 98: 'Eo', 99: 'Ee', 100: 'Unn', 101: 'Unu', 102: 'Unb', 103: 'Unt', 104: 'Unq', 105: 'Unp', 106: 'Unh', 107: 'Uns', 108: 'Uno', 109: 'Une', 110: 'Uun', 111: 'Uuu', 112: 'Uub', 113: 'Uut', 114: 'Uuq', 115: 'Uup', 116: 'Uuh', 117: 'Uus', 118: 'Uuo'}
elements_system_name = {1: 'Unium', 2: 'Bium', 3: 'Trium', 4: 'Quadium', 5: 'Pentium', 6: 'Hexium', 7: 'Septium', 8: 'Octium', 9: 'Ennium', 10: 'Unnilium', 11: 'Ununium', 12: 'Unbium', 13: 'Untrium', 14: 'Unquadium', 15: 'Unpentium', 16: 'Unhexium', 17: 'Unseptium', 18: 'Unoctium', 19: 'Unennium', 20: 'Binilium', 21: 'Biunium', 22: 'Bibium', 23: 'Bitrium', 24: 'Biquadium', 25: 'Bipentium', 26: 'Bihexium', 27: 'Biseptium', 28: 'Bioctium', 29: 'Biennium', 30: 'Trinilium', 31: 'Triunium', 32: 'Tribium', 33: 'Tritrium', 34: 'Triquadium', 35: 'Tripentium', 36: 'Trihexium', 37: 'Triseptium', 38: 'Trioctium', 39: 'Triennium', 40: 'Quadnilium', 41: 'Quadunium', 42: 'Quadbium', 43: 'Quadtrium', 44: 'Quadquadium', 45: 'Quadpentium', 46: 'Quadhexium', 47: 'Quadseptium', 48: 'Quadoctium', 49: 'Quadennium', 50: 'Pentnilium', 51: 'Pentunium', 52: 'Pentbium', 53: 'Penttrium', 54: 'Pentquadium', 55: 'Pentpentium', 56: 'Penthexium', 57: 'Pentseptium', 58: 'Pentoctium', 59: 'Pentennium', 60: 'Hexnilium', 61: 'Hexunium', 62: 'Hexbium', 63: 'Hextrium', 64: 'Hexquadium', 65: 'Hexpentium', 66: 'Hexhexium', 67: 'Hexseptium', 68: 'Hexoctium', 69: 'Hexennium', 70: 'Septnilium', 71: 'Septunium', 72: 'Septbium', 73: 'Septtrium', 74: 'Septquadium', 75: 'Septpentium', 76: 'Septhexium', 77: 'Septseptium', 78: 'Septoctium', 79: 'Septennium', 80: 'Octnilium', 81: 'Octunium', 82: 'Octbium', 83: 'Octtrium', 84: 'Octquadium', 85: 'Octpentium', 86: 'Octhexium', 87: 'Octseptium', 88: 'Octoctium', 89: 'Octennium', 90: 'Ennilium', 91: 'Ennunium', 92: 'Ennbium', 93: 'Enntrium', 94: 'Ennquadium', 95: 'Ennpentium', 96: 'Ennhexium', 97: 'Ennseptium', 98: 'Ennoctium', 99: 'Ennennium', 100: 'Unnilnilium', 101: 'Unnilunium', 102: 'Unnilbium', 103: 'Unniltrium', 104: 'Unnilquadium', 105: 'Unnilpentium', 106: 'Unnilhexium', 107: 'Unnilseptium', 108: 'Unniloctium', 109: 'Unnilennium', 110: 'Ununnilium', 111: 'Unununium', 112: 'Ununbium', 113: 'Ununtrium', 114: 'Ununquadium', 115: 'Ununpentium', 116: 'Ununhexium', 117: 'Ununseptium', 118: 'Ununoctium'}

root = {0:'nil',1:'un',2:'bi',3:'tri',4:'quad',5:'pent',6:'hex',7:'sept',8:'oct',9:'enn'}

def getein( n ):
    temp = ''
    for ch in list(str(n)):
        temp = temp + root[int(ch)][0]
    return temp.capitalize()

def getesn( n ):
    temp = ''
    for ch in list(str(n)):
        temp = temp+root[int(ch)]
    temp = temp.replace("nnn", "nn") + 'ium'
    return temp.replace("ii","i").capitalize()

# energy level s p d f g
def getle( n ):
    return 2*(2*n - 1)

#Atomic orbital K L M N O P Q R S
def getao( n ):
    return 2*n**2

#period 1 2 3 4 5 6 7 8 9
def getp( n ):
    return (6*n + 2*(n//2)**3 + 9*(n//2)**2 + 7*(n//2) + 2*((n+1)//2)**3 + 3*((n+1)//2)**2 - 5*((n+1)//2))//3

def getf( n ):
    return n//2+1

def gete( n ):
    return 2*(n//2+1)**2 - n//2 - 1

def maxp( n ):
    if n == 1: return 1,1
    else: i = 1
    while n > getp(i): i += 1
    ri = i
    if n - getp(i-1) <= getf(i-1): i -= 1
    return i,ri

def getxybyen( n ):
    if n == 1: return [1,1]
    else: x,y = 0,1
    while n > getp(y): y += 1
    if n - getp(y-1) <= getf(y): x = n - getp(y-1)
    else: x =  n - getp(y) - 1
    return [x,y]

def CreatePTOE( n, mu ):

    mw,rw = maxp(n)
    ml = getao(mw//2+1)

    coordinates = []
    for i in range(n):
        i += 1
        pos = getxybyen(i)
        if pos[0] < 0:
            pos[0] = ml + pos[0] + 1
        coordinates.append([pos[0]*mu,pos[1]*mu])

    import matplotlib.pyplot as plt
    import matplotlib.patches as patches
    from matplotlib import font_manager
    adobe_clean = font_manager.FontProperties(fname='AdobeClean-Regular.ttf')
    # x_values = [coord[0] for coord in coordinates]
    # y_values = [coord[1] for coord in coordinates]
    # plt.scatter(x_values, y_values)
    fig, ax = plt.subplots(figsize=(ml*mu + mu, rw*mu + mu))
    y_range = ax.get_ylim()
    mul = (y_range[1] - y_range[0])*(1/2+1/25)

    for index,coord in enumerate(coordinates):
        x, y = coord
        square = patches.Rectangle((x - mu/2 , y - mu/2), mu, mu, edgecolor='black', facecolor='none')
        ax.add_patch(square)

        ax.text(x-mu/2+mu/25, y-mu/2+mu/25, str(index + 1), fontsize=mul*25, fontproperties=adobe_clean, ha='left', va='top')
        # ax.text(x, y, getein(index + 1), fontsize=mul*50, fontproperties=adobe_clean, ha='center', va='center')
        # ax.text(x, y+mu/4+mu/25, getesn(index + 1), fontsize=mul*12.5, fontproperties=adobe_clean, ha='center', va='top')
        ax.text(x, y, elements_name[index + 1], fontsize=mul*50, fontproperties=adobe_clean, ha='center', va='center')
        ax.text(x, y+mu/4+mu/25, elements_latin_name[index + 1], fontsize=mul*12.5, fontproperties=adobe_clean, ha='center', va='top')

    for y in range(rw):
        y += 1
        square = patches.Rectangle((0 , y*mu - mu/2), mu/2, mu, edgecolor='black', facecolor='none')
        ax.add_patch(square)
        ax.text(0+mu/4, y*mu, str(y), fontsize=mul*37.5, fontproperties=adobe_clean, ha='center', va='center')

    min_y_dict = {}
    for pos in coordinates:
        if pos[0]/mu not in min_y_dict or pos[1] < min_y_dict[pos[0]/mu]:
            min_y_dict[pos[0]/mu] = pos[1]
    
    for x in range(ml):
        x += 1
        square = patches.Rectangle((x*mu - mu/2 , min_y_dict[x] - mu), mu, mu/2, edgecolor='black', facecolor='none')
        ax.add_patch(square)
        ax.text(x*mu, min_y_dict[x]-3*mu/4, str(x), fontsize=mul*37.5, fontproperties=adobe_clean, ha='center', va='center')

    square = patches.Rectangle((0 , 0), mu/2, mu/2, edgecolor='black', facecolor='none')
    ax.add_patch(square)
    triangle = patches.Polygon([(0, 0), (mu/2, mu/2), (0, 0)], closed=False, fill=False, edgecolor='black')
    ax.add_patch(triangle)

    plt.title('Periodic Table of Elements',fontproperties=adobe_clean, fontsize=mul*50)
    plt.xlabel('Groups')
    plt.ylabel('Periods')
    plt.xlim(0, ml+1)
    plt.ylim(rw+1, 0)
    plt.axis('equal')
    plt.axis('off')
    plt.grid()
    plt.savefig(str(n)+'PeriodicTableOfElements.png', bbox_inches="tight", dpi=240)
    # plt.show()
    plt.close()

# for i in range(15):
#     CreatePTOE( getp( i+1 ), 1 )
CreatePTOE( getp( 7 ), 1 )
